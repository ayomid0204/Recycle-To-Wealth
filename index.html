<!DOCTYPE html>
<html lang="en">
>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Recycle To Wealth</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Poppins", sans-serif;
    }

    body {
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden;
      text-align: center;
    }

    .page {
      display: none;
      width: 90%;
      max-width: 400px;
      animation: fadeIn 0.5s ease;
    }

    .active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .btn {
      background-color: #ffcc00;
      color: #000;
      border: none;
      border-radius: 5px;
      padding: 10px 20px;
      cursor: pointer;
      font-weight: bold;
      transition: 0.3s;
      margin-top: 10px;
    }

    .btn:hover {
      background-color: #ffd633;
    }

    .form-input {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border: none;
      border-radius: 5px;
    }

    .voucher-box {
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 10px;
      margin-top: 20px;
    }

    .qr-section img {
      width: 180px;
      height: 180px;
      margin-top: 15px;
    }

    .environment-impact {
      margin-top: 20px;
      background: rgba(255,255,255,0.1);
      border-radius: 8px;
      padding: 10px;
    }

    .impact-title {
      font-weight: bold;
      color: #ffcc00;
    }

    .impact-value {
      font-size: 1.1em;
      margin-top: 5px;
    }

    .welcome-title {
      font-size: 1.8em;
      color: #ffcc00;
      margin-bottom: 10px;
    }

    .welcome-subtext {
      color: #ccc;
      font-size: 1em;
    }
  </style>
</head>
<body>

  <!-- PAGE 1 -->
  <div id="page1" class="page active">
    <h1 class="welcome-title">Welcome to Recycle To Wealth ♻️</h1>
    <p class="welcome-subtext">Turn your plastic bottles into instant cash rewards!</p>
    <button class="btn" onclick="showPage('page2')">Start Recycling</button>
  </div>

  <!-- PAGE 2 -->
  <div id="page2" class="page">
    <h2>Enter Your Details</h2>
    <input type="text" id="fullName" class="form-input" placeholder="Full Name" required>
    <input type="text" id="phoneNumber" class="form-input" placeholder="Phone Number" required>
    <input type="text" id="address" class="form-input" placeholder="Address" required>
    <button class="btn" onclick="saveUserData()">Continue</button>
  </div>

  <!-- PAGE 3 -->
  <div id="page3" class="page">
    <h2>Choose Plastic Type</h2>
    <select id="plasticType" class="form-input">
      <option value="PET">PET Bottles</option>
      <option value="HDPE">HDPE Containers</option>
      <option value="PP">PP Plastics</option>
    </select>
    <button class="btn" onclick="showPage('page4')">Next</button>
  </div>

  <!-- PAGE 4 -->
  <div id="page4" class="page">
    <h2>Enter Bottle Count</h2>
    <input type="number" id="bottleCount" class="form-input" placeholder="Number of bottles" required>
    <button class="btn" onclick="generateVoucher()">Generate Voucher</button>
  </div>

  <!-- PAGE 5 -->
  <div id="page5" class="page">
    <h2>Voucher Generated ✅</h2>
    <div class="voucher-box">
      <p><strong>Voucher ID:</strong> <span id="voucherId"></span></p>
      <p><strong>Name:</strong> <span id="voucherName"></span></p>
      <p><strong>Phone:</strong> <span id="voucherPhone"></span></p>
      <p><strong>Address:</strong> <span id="voucherAddress"></span></p>
      <p><strong>Plastic Type:</strong> <span id="voucherType"></span></p>
      <p><strong>Bottles:</strong> <span id="voucherBottles"></span></p>
      <p><strong>Total Worth:</strong> ₦<span id="voucherTotal"></span></p>
    </div>

    <div class="qr-section">
      <div id="qrCode"></div>
    </div>

    <div id="recycleTip" class="welcome-subtext" style="font-style: italic; margin-top: 15px;"></div>

    <div class="environment-impact">
      <div class="impact-title">Recycling Progress</div>
      <div class="impact-value" id="recycleStreak">Day 1 of 100</div>
    </div>

    <button class="btn" onclick="startNew()">New Voucher</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/qrcode-generator/qrcode.js"></script>
  <script>
    let userData = {};
    let currentVoucherData = {};
    const pricePerBottle = 5; // ₦5 per bottle

    // Show Page Function
    function showPage(pageId) {
      document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
      document.getElementById(pageId).classList.add("active");
    }

    // Save User Info
    function saveUserData() {
      const fullName = document.getElementById("fullName").value.trim();
      const phoneNumber = document.getElementById("phoneNumber").value.trim();
      const address = document.getElementById("address").value.trim();

      if (!fullName || !phoneNumber || !address) {
        alert("Please fill all fields");
        return;
      }

      userData = { fullName, phoneNumber, address };
      showPage("page3");
    }

    // Generate Voucher
    function generateVoucher() {
      const bottleCount = parseInt(document.getElementById("bottleCount").value);
      const plasticType = document.getElementById("plasticType").value;

      if (isNaN(bottleCount) || bottleCount <= 0) {
        alert("Enter a valid number of bottles");
        return;
      }

      const voucherId = "RTW-" + new Date().getFullYear() + "-" + Math.floor(1000 + Math.random() * 9000);
      const total = bottleCount * pricePerBottle;

      currentVoucherData = {
        voucherId,
        userName: userData.fullName,
        userPhone: userData.phoneNumber,
        userAddress: userData.address,
        type: plasticType,
        bottles: bottleCount,
        total,
        timestamp: new Date().toISOString(),
      };

      // Store in sessionStorage (short URL)
      sessionStorage.setItem("voucherData", JSON.stringify(currentVoucherData));

      // Generate QR linking to same app
      const voucherUrl = `${window.location.origin}${window.location.pathname}?voucher=true`;
      const qr = qrcode(0, "L");
      qr.addData(voucherUrl);
      qr.make();
      document.getElementById("qrCode").innerHTML = qr.createImgTag(4, 0);

      // Display Voucher Info
      document.getElementById("voucherId").textContent = voucherId;
      document.getElementById("voucherName").textContent = userData.fullName;
      document.getElementById("voucherPhone").textContent = userData.phoneNumber;
      document.getElementById("voucherAddress").textContent = userData.address;
      document.getElementById("voucherType").textContent = plasticType;
      document.getElementById("voucherBottles").textContent = bottleCount;
      document.getElementById("voucherTotal").textContent = total;

      // Show Tip + Streak
      showRecycleTip();
      updateStreak();

      showPage("page5");
    }

    // Check for voucher reload
    function checkForVoucherInURL() {
      const params = new URLSearchParams(window.location.search);
      if (params.has("voucher")) {
        const voucherData = JSON.parse(sessionStorage.getItem("voucherData") || "{}");
        if (voucherData.voucherId) {
          userData = {
            fullName: voucherData.userName,
            phoneNumber: voucherData.userPhone,
            address: voucherData.userAddress
          };
          document.getElementById("voucherId").textContent = voucherData.voucherId;
          document.getElementById("voucherName").textContent = voucherData.userName;
          document.getElementById("voucherPhone").textContent = voucherData.userPhone;
          document.getElementById("voucherAddress").textContent = voucherData.userAddress;
          document.getElementById("voucherType").textContent = voucherData.type;
          document.getElementById("voucherBottles").textContent = voucherData.bottles;
          document.getElementById("voucherTotal").textContent = voucherData.total;

          showRecycleTip();
          updateStreak();

          showPage("page5");
        }
      }
    }

    // Random Tip
    function showRecycleTip() {
      const tips = [
        "Clean bottles before recycling — it increases their value!",
        "Remove caps before recycling for smoother processing.",
        "Flatten bottles to save space in bins.",
        "Recycling 10 bottles saves enough energy to power a bulb for 8 hours.",
        "Invite friends — more recycling, more rewards!"
      ];
      document.getElementById("recycleTip").textContent = 
        "Tip: " + tips[Math.floor(Math.random() * tips.length)];
    }

    // 100-day streak tracker
    function updateStreak() {
      let day = parseInt(localStorage.getItem("recycleDay") || "1");
      if (day < 100) localStorage.setItem("recycleDay", day + 1);
      document.getElementById("recycleStreak").textContent = `Day ${day} of 100`;
    }

    // New voucher
    function startNew() {
      showPage("page1");
    }

    // On load
    checkForVoucherInURL();
  </script>
</body>
</html>
